knitr::opts_chunk$set(echo = TRUE)
tt <- readr::read_csv("tips-2010-01.csv")
object.size(tt)
tt <- readr::read_csv("tips-2010-01.csv")
object.size(tt)
str(tt)
tt <- readr::read_csv("tips-2010-01.csv", show_col_types = FALSE)
object.size(tt)
str(tt)
object.size(tt) / 1e6
object.size(tt)
ls()
str(tt)
table(tt$payment_type)
tt$payment_type[tt$payment_type == "CAS" | tt$payment_type == "Cas"] = "cash"
tt$payment_type[tt$payment_type == "CRE" | tt$payment_type == "Cre"] = "credit-card"
tt$payment_type[tt$payment_type == "Dis"] = "disputed"
tt$payment_type[tt$payment_type == "No"] = "no-charge"
table(tt$payment_type)
summary(tt)
hist(tt$tip_amount)
hist(tt$total_amount)
sum(tt$tip_amount < 0.009) / nrow(tt)
sum(tt$total_amount > 200)
max_totals <- head(tt[rev(order(tt$total_amount)),], 1000)
tipped <- tt[tt$tip_amount > 0.009, "payment_type"]
table(tipped)
not_tipped <- tt[tt$tip_amount <= 0.009, "payment_type"]
table(not_tipped)
credit <- subset(tt, payment_type == "credit-card")
credit$pre_tip <- credit$total_amount - credit$tip_amount
test_ind <- sample(nrow(credit), nrow(credit)/10)
train <- credit[-test_ind,]
test <- credit[test_ind,]
fit <- lm(tip_amount ~ pre_tip, data=train)
pred <- predict(fit, test)
summary(fit)
plot(test, pch='.')
q()
ls()
capabilities()[["X11"]]
capabilities()[["X11"]] = T
capabilities()
capabilities()["X11"] = T
capabilities("X11"=T)
q()
plot(1:10)
plot(1:10)
capabilities()[["X11"]]
png("test.png")
plot(1:10)
dev.off()
png("test.png")
plot(test, pch='.')
points(pred, pch='.', col=2)
dev.off()
png("test.png")
plot(tip_amount ~ pre_tip, data=test, pch='.')
points(tip_amount ~ pre_tip, data=pred, pch='.', col=2)
str(pred)
points(pred, pch='.', col=2)
dev.off()
png("test.png")
plot(tip_amount ~ pre_tip, data=test, pch='.')
points(pred, type='l', col=2)
dev.off()
str(pred)
str(pred[order(pred)])
png("test.png")
plot(tip_amount ~ pre_tip, data=test, pch='.')
lines(pred[order(pred)], col=2)
dev.off()
png("test.png")
plot(tip_amount ~ pre_tip, data=test, pch='.')
lines(fit, col=2)
coef(fit)
lines(coef(fit), col=2)
dev.off()
png("test.png")
plot(tip_amount ~ pre_tip, data=test, pch='.')
abline(coef(fit))
dev.off()
sum(test$tip_amount == test$pre_tip * 0.1)
sum(test$tip_amount == test$pre_tip * 0.15)
sum(test$tip_amount == test$pre_tip * 0.20)
sum(test$tip_amount == test$pre_tip * 0.25)
sum(test$tip_amount == test$pre_tip * 0.215)
sum(test$tip_amount == test$pre_tip)
sum(test$tip_amount == test$pre_tip * 0.20) / nrow(test)
sum(test$tip_amount == as.integer(test$tip_amount)) / nrow(test)
sum(test$pre_tip == as.integer(test$pre_tip)) / nrow(test)
sum((test$tip_amount / test$pre_tip) == as.integer(test$tip_amount / test$pre_trip)) / nrow(test)
sum((test$tip_amount / test$pre_tip) == as.integer(100*test$tip_amount / test$pre_trip)) / nrow(test)
head(as.integer(100*test$tip_amount / test$pre_trip), 5)
head(100*test$tip_amount / test$pre_trip, 5)
nrow(test)
head(test)
head(test$tip_amount / test$pre_tip)
head(100 * test$tip_amount / test$pre_tip)
head(as.integer(100 * test$tip_amount / test$pre_tip))
head((test$tip_amount / test$pre_tip) == as.integer(100 * test$tip_amount / test$pre_tip))
head(sum((test$tip_amount / test$pre_tip) == as.integer(100 * test$tip_amount / test$pre_tip)))
head(sum((test$tip_amount / test$pre_tip) == as.integer(100 * test$tip_amount / test$pre_tip)) / nrow(test))
head(sum(near(test$tip_amount / test$pre_tip), as.integer(100 * test$tip_amount / test$pre_tip))) / nrow(test))
head(sum(near(test$tip_amount / test$pre_tip), as.integer(100 * test$tip_amount / test$pre_tip)) / nrow(test))
head(sum(equal(test$tip_amount / test$pre_tip), as.integer(100 * test$tip_amount / test$pre_tip)) / nrow(test))
head(sum(any.equal(test$tip_amount / test$pre_tip), as.integer(100 * test$tip_amount / test$pre_tip)) / nrow(test))
head(sum((test$tip_amount / test$pre_tip) - as.integer(100 * test$tip_amount / test$pre_tip) < 0.01) / nrow(test))
head(sum((test$tip_amount / test$pre_tip) - as.integer(test$tip_amount / test$pre_tip) < 0.01) / nrow(test))
head(sum((test$tip_amount / test$pre_tip) - as.integer(test$tip_amount / test$pre_tip) < 0.001) / nrow(test))
head(sum((test$tip_amount / test$pre_tip) - as.integer(test$tip_amount / test$pre_tip) < 0.009) / nrow(test))
sum((test$tip_amount / test$pre_tip) - as.integer(test$tip_amount / test$pre_tip) < 0.009) / nrow(test)
sum((100 * test$tip_amount / test$pre_tip) - as.integer(100 * test$tip_amount / test$pre_tip) < 0.009) / nrow(test)
time bzip2 -dc /course/data/nyctaxi/csv/yellow_tripdata_2010-01.csv.bz2 | wc -l
q()
str(tt)
sum(tt$tip_amount < 0.009) / nrow(tt)
sum(tt$tip_amount < 0.009) / nrow(tt)
q()
